<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>時間割作成ソフト</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>🏫 時間割作成ソフト</h1>
            <p>学校用時間割を効率的に作成・管理</p>
        </header>

        <nav class="tabs">
            <button class="tab-btn active" data-tab="data-input">
                <i class="fas fa-user-plus"></i> データ入力
            </button>
            <button class="tab-btn" data-tab="schedule">
                <i class="fas fa-calendar-alt"></i> 時間割作成
            </button>
            <button class="tab-btn" data-tab="output">
                <i class="fas fa-download"></i> 出力
            </button>
        </nav>

        <main>
            <!-- データ入力タブ -->
            <div id="data-input" class="tab-content active">
                <div class="section">
                    <h2><i class="fas fa-chalkboard-teacher"></i> 教員情報</h2>
                    
                    <!-- 基本情報 -->
                    <div class="input-row">
                        <div class="input-group">
                            <input type="text" id="teacher-name" placeholder="教員名">
                        </div>
                    </div>

                    <!-- 担当教科選択 -->
                    <div class="advanced-settings">
                        <h4><i class="fas fa-book"></i> 担当教科選択（最大3つまで）</h4>
                        <div id="teacher-subjects" class="subject-checkboxes">
                            <label class="subject-checkbox">
                                <input type="checkbox" value="国語"> 国語
                            </label>
                            <label class="subject-checkbox">
                                <input type="checkbox" value="社会"> 社会
                            </label>
                            <label class="subject-checkbox">
                                <input type="checkbox" value="数学"> 数学
                            </label>
                            <label class="subject-checkbox">
                                <input type="checkbox" value="理科"> 理科
                            </label>
                            <label class="subject-checkbox">
                                <input type="checkbox" value="音楽"> 音楽
                            </label>
                            <label class="subject-checkbox">
                                <input type="checkbox" value="美術"> 美術
                            </label>
                            <label class="subject-checkbox">
                                <input type="checkbox" value="保健体育"> 保健体育
                            </label>
                            <label class="subject-checkbox">
                                <input type="checkbox" value="技術・家庭"> 技術・家庭
                            </label>
                            <label class="subject-checkbox">
                                <input type="checkbox" value="外国語"> 外国語
                            </label>
                            <label class="subject-checkbox">
                                <input type="checkbox" value="道徳"> 道徳
                            </label>
                            <label class="subject-checkbox">
                                <input type="checkbox" value="総合的な学習の時間"> 総合的な学習の時間
                            </label>
                            <label class="subject-checkbox">
                                <input type="checkbox" value="特別活動"> 特別活動
                            </label>
                        </div>
                    </div>

                    <!-- 担任・副担任設定 -->
                    <div class="advanced-settings">
                        <h4><i class="fas fa-user-graduate"></i> 担任・副担任設定</h4>
                        <div class="homeroom-settings">
                            <div class="homeroom-role">
                                <label>役職:</label>
                                <select id="homeroom-role">
                                    <option value="">選択なし</option>
                                    <option value="main">担任</option>
                                    <option value="sub">副担任</option>
                                </select>
                            </div>
                            <div class="homeroom-class">
                                <label>担当クラス:</label>
                                <select id="homeroom-class" disabled>
                                    <option value="">クラス選択</option>
                                    <!-- JavaScript で動的生成 -->
                                </select>
                            </div>
                            <div class="homeroom-info" id="homeroom-info">
                                <!-- 担任情報表示エリア -->
                            </div>
                        </div>
                    </div>

                    <!-- 担当クラス選択 -->
                    <div class="advanced-settings">
                        <h4><i class="fas fa-school"></i> 授業担当クラス選択</h4>
                        <div id="teaching-classes" class="class-checkboxes">
                            <!-- JavaScript で動的生成 -->
                        </div>
                        <div class="legal-hours-info">
                            <div id="calculated-hours" class="hours-display"></div>
                            <button type="button" onclick="calculateLegalHours()" class="btn-secondary">
                                <i class="fas fa-calculator"></i> 法定時数計算
                            </button>
                        </div>
                    </div>

                    <!-- 授業禁止時間設定 -->
                    <div class="advanced-settings">
                        <h4><i class="fas fa-ban"></i> 授業禁止時間</h4>
                        <div class="time-grid">
                            <div class="time-header">
                                <span></span>
                                <span>月</span>
                                <span>火</span>
                                <span>水</span>
                                <span>木</span>
                                <span>金</span>
                            </div>
                            <div id="forbidden-time-grid" class="time-slots">
                                <!-- JavaScript で動的生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- 複数クラス授業設定 -->
                    <div class="advanced-settings">
                        <h4><i class="fas fa-users-class"></i> 複数クラス合同授業</h4>
                        <div class="input-group">
                            <select id="joint-class-type">
                                <option value="">選択してください</option>
                                <option value="grade-joint">学年合同</option>
                                <option value="custom-joint">選択クラス合同</option>
                            </select>
                            <input type="text" id="joint-class-subject" placeholder="合同授業科目">
                            <input type="number" id="joint-class-hours" placeholder="週時間数" min="1" max="10">
                        </div>
                        <div id="class-selection" class="class-checkboxes" style="display: none;">
                            <!-- JavaScript で動的生成 -->
                        </div>
                    </div>

                    <!-- 会議・委員会設定 -->
                    <div class="advanced-settings">
                        <h4><i class="fas fa-calendar-check"></i> 会議・委員会</h4>
                        <div class="meeting-list">
                            <div class="input-group">
                                <input type="text" id="meeting-name" placeholder="会議・委員会名">
                                <select id="meeting-day">
                                    <option value="">曜日選択</option>
                                    <option value="0">月曜日</option>
                                    <option value="1">火曜日</option>
                                    <option value="2">水曜日</option>
                                    <option value="3">木曜日</option>
                                    <option value="4">金曜日</option>
                                </select>
                                <select id="meeting-period">
                                    <option value="">時限選択</option>
                                    <option value="1">1時間目</option>
                                    <option value="2">2時間目</option>
                                    <option value="3">3時間目</option>
                                    <option value="4">4時間目</option>
                                    <option value="5">5時間目</option>
                                    <option value="6">6時間目</option>
                                </select>
                                <button onclick="addMeeting()" class="btn-secondary">
                                    <i class="fas fa-plus"></i> 会議追加
                                </button>
                            </div>
                            <div id="meetings-list" class="meetings-display"></div>
                        </div>
                    </div>

                    <div class="teacher-actions">
                        <button onclick="addTeacher()" class="btn-primary">
                            <i class="fas fa-plus"></i> 教員追加
                        </button>
                        <button onclick="resetTeacherForm()" class="btn-secondary">
                            <i class="fas fa-undo"></i> リセット
                        </button>
                        <button onclick="toggleBulkMode()" class="btn-validate" id="bulk-mode-btn">
                            <i class="fas fa-users-cog"></i> 一括追加モード
                        </button>
                    </div>

                    <!-- 一括追加モード -->
                    <div id="bulk-add-mode" class="bulk-add-container" style="display: none;">
                        <div class="bulk-info">
                            <p class="info-text">
                                <i class="fas fa-lightbulb"></i> 
                                <strong>効率的な一括登録方法:</strong> 
                                1. CSVテンプレートをダウンロード → 2. Excelで教員情報を入力 → 3. CSVファイルを読み込み
                            </p>
                        </div>
                        <div class="bulk-header">
                            <h4><i class="fas fa-users-cog"></i> 教員一括追加</h4>
                            <div class="bulk-actions">
                                <button onclick="downloadTeacherCSVTemplate()" class="btn-primary">
                                    <i class="fas fa-file-download"></i> CSVテンプレート
                                </button>
                                <button onclick="downloadCSVInstructions()" class="btn-secondary">
                                    <i class="fas fa-info-circle"></i> 入力説明書
                                </button>
                                <button onclick="importCSV()" class="btn-secondary">
                                    <i class="fas fa-file-csv"></i> CSV読込
                                </button>
                                <button onclick="addBulkRow()" class="btn-load">
                                    <i class="fas fa-plus"></i> 行追加
                                </button>
                            </div>
                        </div>

                        <div class="bulk-table-container">
                            <table id="bulk-teacher-table" class="bulk-table">
                                <thead>
                                    <tr>
                                        <th style="width: 120px;">教員名</th>
                                        <th style="width: 100px;">担当教科</th>
                                        <th style="width: 200px;">担当クラス</th>
                                        <th style="width: 80px;">担任役職</th>
                                        <th style="width: 100px;">担任クラス</th>
                                        <th style="width: 80px;">週時数</th>
                                        <th style="width: 150px;">禁止時間</th>
                                        <th style="width: 120px;">会議</th>
                                        <th style="width: 80px;">操作</th>
                                    </tr>
                                </thead>
                                <tbody id="bulk-teacher-tbody">
                                    <!-- JavaScript で動的生成 -->
                                </tbody>
                            </table>
                        </div>

                        <div class="bulk-footer">
                            <div class="bulk-preview">
                                <button onclick="previewBulkAdd()" class="btn-validate">
                                    <i class="fas fa-eye"></i> プレビュー
                                </button>
                                <div id="bulk-preview-result" class="preview-result"></div>
                            </div>
                            <div class="bulk-submit">
                                <button onclick="submitBulkAdd()" class="btn-primary">
                                    <i class="fas fa-check"></i> 一括追加実行
                                </button>
                                <button onclick="clearBulkTable()" class="btn-secondary">
                                    <i class="fas fa-trash"></i> 全てクリア
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="teacher-list" class="data-list"></div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-users"></i> 学年・学級情報</h2>
                    <p class="info-text">
                        <i class="fas fa-info-circle"></i> 
                        デフォルトで各学年1組〜10組（通常学級）が用意されています。各クラスの「学級種別」を変更することで特別支援学級に設定できます。不要なクラスは削除してください。
                    </p>
                    
                    <div class="class-management-actions">
                        <button onclick="resetToDefaultClasses()" class="btn-reset">
                            <i class="fas fa-undo-alt"></i> デフォルトクラスに戻す
                        </button>
                        <button onclick="addNewClass()" class="btn-secondary">
                            <i class="fas fa-plus"></i> クラス追加
                        </button>
                    </div>
                    
                    <div id="class-list" class="data-list"></div>
                    
                    <!-- 特別支援クラス教科時数設定 -->
                    <div class="section special-support-section">
                        <h3><i class="fas fa-heart"></i> 特別支援クラス教科時数設定</h3>
                        <p class="info-text">
                            <i class="fas fa-info-circle"></i> 
                            特別支援クラスの個別の教科時数を設定できます。標準の時数と異なる場合に調整してください。
                        </p>
                        
                        <div class="special-class-selector">
                            <label for="special-class-select">対象クラス:</label>
                            <select id="special-class-select">
                                <option value="">クラスを選択してください</option>
                            </select>
                        </div>
                        
                        <div id="special-hours-settings" class="special-hours-container" style="display: none;">
                            <h4>教科時数設定</h4>
                            <div class="hours-grid">
                                <div class="subject-hours-item">
                                    <label>国語:</label>
                                    <input type="number" id="special-hours-japanese" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item">
                                    <label>社会:</label>
                                    <input type="number" id="special-hours-social" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item">
                                    <label>数学:</label>
                                    <input type="number" id="special-hours-math" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item">
                                    <label>理科:</label>
                                    <input type="number" id="special-hours-science" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item">
                                    <label>音楽:</label>
                                    <input type="number" id="special-hours-music" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item">
                                    <label>美術:</label>
                                    <input type="number" id="special-hours-art" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item">
                                    <label>保健体育:</label>
                                    <input type="number" id="special-hours-pe" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item">
                                    <label>技術・家庭:</label>
                                    <input type="number" id="special-hours-tech" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item">
                                    <label>外国語:</label>
                                    <input type="number" id="special-hours-english" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item">
                                    <label>道徳:</label>
                                    <input type="number" id="special-hours-moral" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item">
                                    <label>総合的な学習の時間:</label>
                                    <input type="number" id="special-hours-integrated" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item">
                                    <label>特別活動:</label>
                                    <input type="number" id="special-hours-special" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item">
                                    <label>自立活動:</label>
                                    <input type="number" id="special-hours-independence" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                                <div class="subject-hours-item" id="daily-life-unit-item" style="display: none;">
                                    <label>生活単元:</label>
                                    <input type="number" id="special-hours-daily-life" min="0" max="10" step="0.5" placeholder="時数">
                                </div>
                            </div>
                            
                            <div class="hours-summary">
                                <div class="total-hours">
                                    <strong>合計時数: <span id="special-total-hours">0</span>時間/週</strong>
                                </div>
                                <div class="standard-comparison">
                                    <span>標準時数との差: <span id="hours-difference">0</span>時間</span>
                                </div>
                            </div>
                            
                            <div class="special-hours-actions">
                                <button onclick="saveSpecialHours()" class="btn-primary">
                                    <i class="fas fa-save"></i> 時数設定保存
                                </button>
                                <button onclick="resetToStandardHours()" class="btn-secondary">
                                    <i class="fas fa-undo"></i> 標準時数に戻す
                                </button>
                                <button onclick="copyFromStandardClass()" class="btn-load">
                                    <i class="fas fa-copy"></i> 標準学級からコピー
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-door-open"></i> 教室情報</h2>
                    <p class="info-text">
                        <i class="fas fa-info-circle"></i> 
                        デフォルトで普通教室（各学年1〜10組）と特別教室（理科室A/B、音楽室、美術室、技術室、体育館）が用意されています。不要な教室は削除してください。
                    </p>
                    <div id="room-list" class="data-list"></div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-clock"></i> 固定教科設定</h2>
                    <p class="info-text">
                        <i class="fas fa-info-circle"></i> 
                        学級活動・道徳・総合的な学習の時間を学年単位で希望する曜日・時間目に固定して設定できます。設定しない場合は自動配置されます。
                    </p>

                    <!-- 学年・教科設定フォーム -->
                    <div class="fixed-schedule-container">
                        
                        <!-- 1年生設定 -->
                        <div class="grade-schedule-section">
                            <h3><i class="fas fa-graduation-cap"></i> 1年生</h3>
                            
                            <!-- 1年 学級活動 -->
                            <div class="fixed-subject-setting">
                                <h4><i class="fas fa-users-class"></i> 学級活動</h4>
                                <div class="subject-schedule-options">
                                    <label class="schedule-option">
                                        <input type="radio" name="grade1-homeroom-schedule" value="auto" checked>
                                        自動配置
                                    </label>
                                    <label class="schedule-option">
                                        <input type="radio" name="grade1-homeroom-schedule" value="fixed">
                                        固定配置
                                    </label>
                                </div>
                                <div class="schedule-selection" id="grade1-homeroom-schedule-selection" style="display: none;">
                                    <div class="schedule-grid">
                                        <div class="schedule-row">
                                            <label>曜日:</label>
                                            <select id="grade1-homeroom-day">
                                                <option value="">選択してください</option>
                                                <option value="0">月曜日</option>
                                                <option value="1">火曜日</option>
                                                <option value="2">水曜日</option>
                                                <option value="3">木曜日</option>
                                                <option value="4">金曜日</option>
                                            </select>
                                        </div>
                                        <div class="schedule-row">
                                            <label>時間目:</label>
                                            <select id="grade1-homeroom-period">
                                                <option value="">選択してください</option>
                                                <option value="1">1時間目</option>
                                                <option value="2">2時間目</option>
                                                <option value="3">3時間目</option>
                                                <option value="4">4時間目</option>
                                                <option value="5">5時間目</option>
                                                <option value="6">6時間目</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 1年 道徳 -->
                            <div class="fixed-subject-setting">
                                <h4><i class="fas fa-heart"></i> 道徳</h4>
                                <div class="subject-schedule-options">
                                    <label class="schedule-option">
                                        <input type="radio" name="grade1-moral-schedule" value="auto" checked>
                                        自動配置
                                    </label>
                                    <label class="schedule-option">
                                        <input type="radio" name="grade1-moral-schedule" value="fixed">
                                        固定配置
                                    </label>
                                </div>
                                <div class="schedule-selection" id="grade1-moral-schedule-selection" style="display: none;">
                                    <div class="schedule-grid">
                                        <div class="schedule-row">
                                            <label>曜日:</label>
                                            <select id="grade1-moral-day">
                                                <option value="">選択してください</option>
                                                <option value="0">月曜日</option>
                                                <option value="1">火曜日</option>
                                                <option value="2">水曜日</option>
                                                <option value="3">木曜日</option>
                                                <option value="4">金曜日</option>
                                            </select>
                                        </div>
                                        <div class="schedule-row">
                                            <label>時間目:</label>
                                            <select id="grade1-moral-period">
                                                <option value="">選択してください</option>
                                                <option value="1">1時間目</option>
                                                <option value="2">2時間目</option>
                                                <option value="3">3時間目</option>
                                                <option value="4">4時間目</option>
                                                <option value="5">5時間目</option>
                                                <option value="6">6時間目</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 1年 総合的な学習の時間 -->
                            <div class="fixed-subject-setting">
                                <h4><i class="fas fa-puzzle-piece"></i> 総合的な学習の時間</h4>
                                <div class="subject-schedule-options">
                                    <label class="schedule-option">
                                        <input type="radio" name="grade1-integrated-schedule" value="auto" checked>
                                        自動配置
                                    </label>
                                    <label class="schedule-option">
                                        <input type="radio" name="grade1-integrated-schedule" value="fixed">
                                        固定配置
                                    </label>
                                </div>
                                <div class="schedule-selection" id="grade1-integrated-schedule-selection" style="display: none;">
                                    <div class="schedule-grid">
                                        <div class="schedule-row">
                                            <label>曜日:</label>
                                            <select id="grade1-integrated-day">
                                                <option value="">選択してください</option>
                                                <option value="0">月曜日</option>
                                                <option value="1">火曜日</option>
                                                <option value="2">水曜日</option>
                                                <option value="3">木曜日</option>
                                                <option value="4">金曜日</option>
                                            </select>
                                        </div>
                                        <div class="schedule-row">
                                            <label>時間目:</label>
                                            <select id="grade1-integrated-period">
                                                <option value="">選択してください</option>
                                                <option value="1">1時間目</option>
                                                <option value="2">2時間目</option>
                                                <option value="3">3時間目</option>
                                                <option value="4">4時間目</option>
                                                <option value="5">5時間目</option>
                                                <option value="6">6時間目</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 2年生設定 -->
                        <div class="grade-schedule-section">
                            <h3><i class="fas fa-graduation-cap"></i> 2年生</h3>
                            
                            <!-- 2年 学級活動 -->
                            <div class="fixed-subject-setting">
                                <h4><i class="fas fa-users-class"></i> 学級活動</h4>
                                <div class="subject-schedule-options">
                                    <label class="schedule-option">
                                        <input type="radio" name="grade2-homeroom-schedule" value="auto" checked>
                                        自動配置
                                    </label>
                                    <label class="schedule-option">
                                        <input type="radio" name="grade2-homeroom-schedule" value="fixed">
                                        固定配置
                                    </label>
                                </div>
                                <div class="schedule-selection" id="grade2-homeroom-schedule-selection" style="display: none;">
                                    <div class="schedule-grid">
                                        <div class="schedule-row">
                                            <label>曜日:</label>
                                            <select id="grade2-homeroom-day">
                                                <option value="">選択してください</option>
                                                <option value="0">月曜日</option>
                                                <option value="1">火曜日</option>
                                                <option value="2">水曜日</option>
                                                <option value="3">木曜日</option>
                                                <option value="4">金曜日</option>
                                            </select>
                                        </div>
                                        <div class="schedule-row">
                                            <label>時間目:</label>
                                            <select id="grade2-homeroom-period">
                                                <option value="">選択してください</option>
                                                <option value="1">1時間目</option>
                                                <option value="2">2時間目</option>
                                                <option value="3">3時間目</option>
                                                <option value="4">4時間目</option>
                                                <option value="5">5時間目</option>
                                                <option value="6">6時間目</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 2年 道徳 -->
                            <div class="fixed-subject-setting">
                                <h4><i class="fas fa-heart"></i> 道徳</h4>
                                <div class="subject-schedule-options">
                                    <label class="schedule-option">
                                        <input type="radio" name="grade2-moral-schedule" value="auto" checked>
                                        自動配置
                                    </label>
                                    <label class="schedule-option">
                                        <input type="radio" name="grade2-moral-schedule" value="fixed">
                                        固定配置
                                    </label>
                                </div>
                                <div class="schedule-selection" id="grade2-moral-schedule-selection" style="display: none;">
                                    <div class="schedule-grid">
                                        <div class="schedule-row">
                                            <label>曜日:</label>
                                            <select id="grade2-moral-day">
                                                <option value="">選択してください</option>
                                                <option value="0">月曜日</option>
                                                <option value="1">火曜日</option>
                                                <option value="2">水曜日</option>
                                                <option value="3">木曜日</option>
                                                <option value="4">金曜日</option>
                                            </select>
                                        </div>
                                        <div class="schedule-row">
                                            <label>時間目:</label>
                                            <select id="grade2-moral-period">
                                                <option value="">選択してください</option>
                                                <option value="1">1時間目</option>
                                                <option value="2">2時間目</option>
                                                <option value="3">3時間目</option>
                                                <option value="4">4時間目</option>
                                                <option value="5">5時間目</option>
                                                <option value="6">6時間目</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 2年 総合的な学習の時間 -->
                            <div class="fixed-subject-setting">
                                <h4><i class="fas fa-puzzle-piece"></i> 総合的な学習の時間</h4>
                                <div class="subject-schedule-options">
                                    <label class="schedule-option">
                                        <input type="radio" name="grade2-integrated-schedule" value="auto" checked>
                                        自動配置
                                    </label>
                                    <label class="schedule-option">
                                        <input type="radio" name="grade2-integrated-schedule" value="fixed">
                                        固定配置
                                    </label>
                                </div>
                                <div class="schedule-selection" id="grade2-integrated-schedule-selection" style="display: none;">
                                    <div class="schedule-grid">
                                        <div class="schedule-row">
                                            <label>曜日:</label>
                                            <select id="grade2-integrated-day">
                                                <option value="">選択してください</option>
                                                <option value="0">月曜日</option>
                                                <option value="1">火曜日</option>
                                                <option value="2">水曜日</option>
                                                <option value="3">木曜日</option>
                                                <option value="4">金曜日</option>
                                            </select>
                                        </div>
                                        <div class="schedule-row">
                                            <label>時間目:</label>
                                            <select id="grade2-integrated-period">
                                                <option value="">選択してください</option>
                                                <option value="1">1時間目</option>
                                                <option value="2">2時間目</option>
                                                <option value="3">3時間目</option>
                                                <option value="4">4時間目</option>
                                                <option value="5">5時間目</option>
                                                <option value="6">6時間目</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 3年生設定 -->
                        <div class="grade-schedule-section">
                            <h3><i class="fas fa-graduation-cap"></i> 3年生</h3>
                            
                            <!-- 3年 学級活動 -->
                            <div class="fixed-subject-setting">
                                <h4><i class="fas fa-users-class"></i> 学級活動</h4>
                                <div class="subject-schedule-options">
                                    <label class="schedule-option">
                                        <input type="radio" name="grade3-homeroom-schedule" value="auto" checked>
                                        自動配置
                                    </label>
                                    <label class="schedule-option">
                                        <input type="radio" name="grade3-homeroom-schedule" value="fixed">
                                        固定配置
                                    </label>
                                </div>
                                <div class="schedule-selection" id="grade3-homeroom-schedule-selection" style="display: none;">
                                    <div class="schedule-grid">
                                        <div class="schedule-row">
                                            <label>曜日:</label>
                                            <select id="grade3-homeroom-day">
                                                <option value="">選択してください</option>
                                                <option value="0">月曜日</option>
                                                <option value="1">火曜日</option>
                                                <option value="2">水曜日</option>
                                                <option value="3">木曜日</option>
                                                <option value="4">金曜日</option>
                                            </select>
                                        </div>
                                        <div class="schedule-row">
                                            <label>時間目:</label>
                                            <select id="grade3-homeroom-period">
                                                <option value="">選択してください</option>
                                                <option value="1">1時間目</option>
                                                <option value="2">2時間目</option>
                                                <option value="3">3時間目</option>
                                                <option value="4">4時間目</option>
                                                <option value="5">5時間目</option>
                                                <option value="6">6時間目</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 3年 道徳 -->
                            <div class="fixed-subject-setting">
                                <h4><i class="fas fa-heart"></i> 道徳</h4>
                                <div class="subject-schedule-options">
                                    <label class="schedule-option">
                                        <input type="radio" name="grade3-moral-schedule" value="auto" checked>
                                        自動配置
                                    </label>
                                    <label class="schedule-option">
                                        <input type="radio" name="grade3-moral-schedule" value="fixed">
                                        固定配置
                                    </label>
                                </div>
                                <div class="schedule-selection" id="grade3-moral-schedule-selection" style="display: none;">
                                    <div class="schedule-grid">
                                        <div class="schedule-row">
                                            <label>曜日:</label>
                                            <select id="grade3-moral-day">
                                                <option value="">選択してください</option>
                                                <option value="0">月曜日</option>
                                                <option value="1">火曜日</option>
                                                <option value="2">水曜日</option>
                                                <option value="3">木曜日</option>
                                                <option value="4">金曜日</option>
                                            </select>
                                        </div>
                                        <div class="schedule-row">
                                            <label>時間目:</label>
                                            <select id="grade3-moral-period">
                                                <option value="">選択してください</option>
                                                <option value="1">1時間目</option>
                                                <option value="2">2時間目</option>
                                                <option value="3">3時間目</option>
                                                <option value="4">4時間目</option>
                                                <option value="5">5時間目</option>
                                                <option value="6">6時間目</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 3年 総合的な学習の時間 -->
                            <div class="fixed-subject-setting">
                                <h4><i class="fas fa-puzzle-piece"></i> 総合的な学習の時間</h4>
                                <div class="subject-schedule-options">
                                    <label class="schedule-option">
                                        <input type="radio" name="grade3-integrated-schedule" value="auto" checked>
                                        自動配置
                                    </label>
                                    <label class="schedule-option">
                                        <input type="radio" name="grade3-integrated-schedule" value="fixed">
                                        固定配置
                                    </label>
                                </div>
                                <div class="schedule-selection" id="grade3-integrated-schedule-selection" style="display: none;">
                                    <div class="schedule-grid">
                                        <div class="schedule-row">
                                            <label>曜日:</label>
                                            <select id="grade3-integrated-day">
                                                <option value="">選択してください</option>
                                                <option value="0">月曜日</option>
                                                <option value="1">火曜日</option>
                                                <option value="2">水曜日</option>
                                                <option value="3">木曜日</option>
                                                <option value="4">金曜日</option>
                                            </select>
                                        </div>
                                        <div class="schedule-row">
                                            <label>時間目:</label>
                                            <select id="grade3-integrated-period">
                                                <option value="">選択してください</option>
                                                <option value="1">1時間目</option>
                                                <option value="2">2時間目</option>
                                                <option value="3">3時間目</option>
                                                <option value="4">4時間目</option>
                                                <option value="5">5時間目</option>
                                                <option value="6">6時間目</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 設定の競合チェック表示 -->
                        <div id="grade-subject-conflict-warning" class="conflict-warning" style="display: none;">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>設定に競合があります。同じ時間に複数の教科が設定されています。</span>
                        </div>

                        <!-- アクションボタン -->
                        <div class="fixed-schedule-actions">
                            <button onclick="saveGradeSubjectSchedule()" class="btn-primary">
                                <i class="fas fa-save"></i> 設定保存
                            </button>
                            <button onclick="resetGradeSubjectSchedule()" class="btn-secondary">
                                <i class="fas fa-undo"></i> リセット
                            </button>
                            <button onclick="previewGradeSubjectSchedule()" class="btn-validate">
                                <i class="fas fa-eye"></i> プレビュー
                            </button>
                        </div>

                        <!-- プレビュー表示 -->
                        <div id="grade-subject-preview" class="schedule-preview" style="display: none;">
                            <h5>設定プレビュー</h5>
                            <div id="grade-subject-preview-content"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 時間割作成タブ -->
            <div id="schedule" class="tab-content">
                <div class="controls">
                    <button onclick="generateTimetable()" class="btn-primary">
                        <i class="fas fa-magic"></i> 自動時間割作成
                    </button>
                    <button onclick="clearTimetable()" class="btn-secondary">
                        <i class="fas fa-eraser"></i> クリア
                    </button>
                    <button onclick="validateTimetable()" class="btn-validate">
                        <i class="fas fa-check-circle"></i> 矛盾チェック
                    </button>
                </div>
                
                <div id="timetable-container">
                    <table id="timetable">
                        <!-- JavaScriptで動的生成 -->
                    </table>
                </div>

                <div id="validation-results"></div>
            </div>

            <!-- 出力タブ -->
            <div id="output" class="tab-content">
                <div class="output-controls">
                    <button onclick="printTimetable()" class="btn-primary">
                        <i class="fas fa-print"></i> 印刷
                    </button>
                    <button onclick="exportTimetable()" class="btn-secondary">
                        <i class="fas fa-file-excel"></i> Excel出力
                    </button>
                    <button onclick="saveData()" class="btn-save">
                        <i class="fas fa-save"></i> データ保存
                    </button>
                    <button onclick="loadData()" class="btn-load">
                        <i class="fas fa-upload"></i> データ読込
                    </button>
                    <button onclick="clearLocalStorage()" class="btn-secondary" style="background: #dc3545;">
                        <i class="fas fa-trash"></i> 保存データ削除
                    </button>
                </div>
                
                <div class="export-preview">
                    <h3>出力プレビュー</h3>
                    <div id="preview-container"></div>
                </div>
                
                <!-- 法定時数チェック機能 -->
                <div class="legal-hours-check">
                    <h3><i class="fas fa-clipboard-check"></i> 法定時数チェック</h3>
                    <button onclick="checkLegalHoursCompliance()" class="btn-validate">
                        <i class="fas fa-search"></i> 法定時数適合チェック
                    </button>
                    <div id="legal-hours-report" class="legal-hours-report"></div>
                </div>
            </div>
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html>